<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Works - Green Job Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="step-1-bg">
    <nav class="main-nav">
        <a href="index.html" class="nav-brand">Climate Works</a>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
        </ul>
    </nav>
    <div class="container">
        <div class="left-panel">
            <div class="logo-section">
                <!-- Public Seal of Kenya -->
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Public_Seal_of_Kenya.svg/1200px-Public_Seal_of_Kenya.svg.png" alt="Public Seal of Kenya" onerror="this.onerror=null; this.src='https://placehold.co/80x80/0a5c36/ffffff?text=Kenya+Seal'">
                <!-- Green Leaf Logo -->
                <i class="fas fa-leaf leaf-icon"></i>
            </div>
            <h1 class="app-title">Climate Works</h1>
            <p class="app-subtitle">Connecting youth with government job opportunities in environmental sectors</p>
            
            <ul class="features">
                <li><i class="fas fa-check-circle"></i> Find job opportunities in growing sectors</li>
                <li><i class="fas fa-check-circle"></i> Contribute to national development projects</li>
                <li><i class="fas fa-check-circle"></i> Gain valuable work experience</li>
                <li><i class="fas fa-check-circle"></i> Receive fair compensation and benefits</li>
                <li><i class="fas fa-check-circle"></i> Access training and skill development</li>
            </ul>
            
            <h3>Available Sectors:</h3>
            <div class="sectors-list">
                <button type="button" class="sector-button" data-sector-key="housing">
                    <i class="fas fa-building"></i> Housing Development
                </button>
                <button type="button" class="sector-button" data-sector-key="road">
                    <i class="fas fa-road"></i> Road Infrastructure
                </button>
                <button type="button" class="sector-button" data-sector-key="environment">
                    <i class="fas fa-tree"></i> Environment Conservation
                </button>
                <button type="button" class="sector-button" data-sector-key="urban">
                    <i class="fas fa-city"></i> Urban Renewal
                </button>
                <button type="button" class="sector-button" data-sector-key="public">
                    <i class="fas fa-hard-hat"></i> Public Works
                </button>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="form-container">
                <div class="progress-steps">
                    <div class="step active" id="step1">1</div>
                    <div class="step" id="step2">2</div>
                    <div class="step" id="step3">3</div>
                    <div class="step" id="step4">4</div> <!-- Added step 4 for sector details -->
                </div>
                
                <!-- Step 1: Personal Information -->
                <div id="personalInfoStep">
                    <h2 class="form-title">Create Account</h2>
                    <p class="form-subtitle">Join thousands of youth finding meaningful work</p>
                    
                    <form id="signupForm">
                        <div class="form-group">
                            <label for="officialName">Official Names</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" class="form-control" id="officialName" placeholder="Enter your full name" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Gender</label>
                            <div class="gender-options">
                                <div class="gender-option">
                                    <input type="radio" id="male" name="gender" value="male" required>
                                    <label for="male">Male</label>
                                </div>
                                <div class="gender-option">
                                    <input type="radio" id="female" name="gender" value="female">
                                    <label for="female">Female</label>
                                </div>
                                <div class="gender-option">
                                    <input type="radio" id="other" name="gender" value="other">
                                    <label for="other">Other</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="idNumber">National ID Number</label>
                            <div class="input-with-icon">
                                <i class="fas fa-id-card"></i>
                                <input type="text" class="form-control" id="idNumber" placeholder="Enter your ID number" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <div class="input-with-icon">
                                <i class="fas fa-envelope"></i>
                                <input type="email" class="form-control" id="email" placeholder="Enter your email" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="phone">Safaricom Phone Number (Start with 254)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-phone"></i>
                                <input type="tel" class="form-control" id="phone" placeholder="2547XXXXXXXX" pattern="254[0-9]{9}" required>
                            </div>
                            <small class="text-muted">Only Safaricom numbers allowed (format: 2547XXXXXXXX)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="password">Password</label>
                            <div class="input-with-icon">
                                <i class="fas fa-lock"></i>
                                <input type="password" class="form-control" id="password" placeholder="Create a password" required>
                                <i class="fas fa-eye password-toggle-icon" id="togglePassword"></i>
                            </div>
                            <div class="password-strength">
                                <div class="strength-meter" id="passwordStrength"></div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <div class="input-with-icon">
                                <i class="fas fa-lock"></i>
                                <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your password" required>
                                <i class="fas fa-eye password-toggle-icon" id="toggleConfirmPassword"></i>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="sector">Preferred Sector</label>
                            <div class="input-with-icon">
                                <i class="fas fa-briefcase"></i>
                                <select class="form-control" id="sector" required>
                                    <option value="">Select your preferred sector</option>
                                    <option value="housing">Housing Development</option>
                                    <option value="road">Road Infrastructure</option>
                                    <option value="environment">Environment Conservation</option>
                                    <option value="urban">Urban Renewal</option>
                                    <option value="public">Public Works</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="button" class="btn" id="nextBtn1">Next</button>
                    </form>
                </div>
                
                <!-- Step 2: Location Information -->
                <div id="locationStep" class="hidden">
                    <h2 class="form-title">Location Details</h2>
                    <p class="form-subtitle">Please provide your location information</p>
                    
                    <div class="form-group">
                        <label for="county">County</label>
                        <select class="form-control" id="county" required>
                            <option value="">Select your county</option>
                            <option value="nairobi">Nairobi</option>
                            <option value="mombasa">Mombasa</option>
                            <option value="kisumu">Kisumu</option>
                            <option value="nakuru">Nakuru</option>
                            <option value="kiambu">Kiambu</option>
                            <!-- Add more counties as needed -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="constituency">Constituency</label>
                        <select class="form-control" id="constituency" required>
                            <option value="">Select your constituency</option>
                            <!-- Options will be populated based on county selection -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="ward">Ward</label>
                        <select class="form-control" id="ward" required>
                            <option value="">Select your ward</option>
                            <!-- Options will be populated based on constituency selection -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button type="button" class="btn" id="backBtn1">Back</button>
                        <button type="button" class="btn" id="nextBtn2">Next</button>
                    </div>
                </div>
                
                <!-- Step 3: Payment Information -->
                <div id="paymentStep" class="hidden">
                    <h2 class="form-title">Payment Method</h2>
                    <p class="form-subtitle">Select your preferred payment method</p>
                    
                    <div class="form-group">
                        <label>Choose Payment Method</label>
                        <div class="payment-options-container">
                            <div class="payment-option" id="mpesaOption">
                                <input type="radio" name="paymentMethod" id="mpesa" value="mpesa" checked>
                                <i class="fas fa-mobile-alt payment-icon"></i>
                                <div>
                                    <h4>M-Pesa</h4>
                                    <p>Receive payments via M-Pesa</p>
                                </div>
                            </div>
                            
                            <div class="payment-option" id="kcbOption">
                                <input type="radio" name="paymentMethod" id="kcb" value="kcb">
                                <i class="fas fa-university payment-icon"></i>
                                <div>
                                    <h4>KCB Bank</h4>
                                    <p>Receive payments to your KCB account</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-method-details active" id="mpesaMethod">
                        <div class="form-group">
                            <label for="mpesaNumber">M-Pesa Number</label>
                            <div class="input-with-icon">
                                <i class="fas fa-mobile-alt"></i>
                                <input type="tel" class="form-control" id="mpesaNumber" placeholder="2547XXXXXXXX" pattern="254[0-9]{9}" required>
                            </div>
                            <small class="text-muted">Enter your Safaricom M-Pesa number</small>
                        </div>
                    </div>
                    
                    <div class="payment-method-details" id="kcbMethod">
                        <div class="form-group">
                            <label for="accountNumber">KCB Account Number</label>
                            <div class="input-with-icon">
                                <i class="fas fa-credit-card"></i>
                                <input type="text" class="form-control" id="accountNumber" placeholder="Enter your KCB account number" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="accountName">Account Name</label>
                            <input type="text" class="form-control" id="accountName" placeholder="Name as it appears in bank records" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="branch">Branch Name</label>
                            <input type="text" class="form-control" id="branch" placeholder="Branch where account is held" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button type="button" class="btn" id="backBtn2">Back</button>
                        <button type="button" class="btn" id="nextBtn3">Next</button>
                    </div>
                </div>

                <!-- Step 4: Sector Details -->
                <div id="sectorDetailsStep" class="hidden">
                    <h2 class="form-title">Explore Your Sector</h2>
                    <p class="form-subtitle">Learn more about the opportunities in your chosen field.</p>
                    
                    <div id="selectedSectorDisplay">
                        <!-- Sector details will be dynamically loaded here -->
                    </div>

                    <div class="form-group">
                        <button type="button" class="btn" id="backBtn4">Back to Form</button>
                        <button type="submit" class="btn" id="submitBtn">Submit Application</button>
                    </div>
                </div>
                
                <div class="login-link">
                    Already have an account? <a href="#" id="loginLink">Log in</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeModal">&times;</button>
            <h2 class="modal-title">Log In</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope"></i>
                        <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock"></i>
                        <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password" required>
                        <i class="fas fa-eye password-toggle-icon" id="toggleLoginPassword"></i>
                    </div>
                </div>
                <button type="submit" class="btn">Login</button>
                <div class="login-link">
                    <a href="#">Forgot Password?</a>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        // Data for sector details
        const sectorData = {
            housing: {
                name: "Housing Development",
                icon: "fas fa-building",
                entails: "Focuses on planning, designing, constructing, and managing residential properties, including affordable housing initiatives. This sector plays a crucial role in urban planning and providing basic necessities.",
                howItWorks: "Projects typically involve land acquisition, architectural design, securing financing, construction, and property management. It often collaborates with government agencies, private developers, and community organizations.",
                trainings: ["Construction Management (Diploma/Certificate)", "Civil Engineering (Degree/Diploma)", "Architecture (Degree/Diploma)", "Quantity Surveying (Degree/Diploma)", "Plumbing & Electrical Installation (Vocational Training)", "Sustainable Building Practices (Short Course)"],
                facts: ["Contributes significantly to national GDP.", "High demand for skilled labor and tradespeople.", "Innovations include green building technologies and prefabrication.", "Government aims to deliver affordable housing units as a key agenda."],
                benefits: ["Stable job opportunities due to continuous demand.", "Opportunity to contribute to national development.", "Diverse career paths from skilled labor to management.", "Potential for entrepreneurship in construction services."]
            },
            road: {
                name: "Road Infrastructure",
                icon: "fas fa-road",
                entails: "Involves the construction, maintenance, and upgrade of roads, bridges, and related transport networks. This is vital for economic development and connectivity.",
                howItWorks: "Projects involve planning, design, land surveying, material procurement, construction (grading, paving, drainage), and ongoing maintenance. Public-private partnerships are common.",
                trainings: ["Civil Engineering (Degree/Diploma)", "Road Construction & Maintenance (Certificate)", "Heavy Equipment Operation (Vocational Training)", "Land Surveying (Diploma/Certificate)", "Project Management (Certificate)"],
                facts: ["Key driver of economic growth and trade.", "Large-scale government investments in infrastructure projects.", "Focus on improving rural access and urban mobility.", "Adoption of modern road construction techniques."],
                benefits: ["Impactful work improving connectivity and trade.", "Opportunities for large-scale project involvement.", "Skill development in heavy machinery and civil works.", "Good prospects for career progression in engineering roles."]
            },
            environment: {
                name: "Environment Conservation",
                icon: "fas fa-tree",
                entails: "Focuses on protecting natural resources, biodiversity, and ecosystems through sustainable practices, policy development, and community engagement.",
                howItWorks: "Activities include reforestation, wildlife management, waste management, pollution control, environmental impact assessments, and climate change adaptation/mitigation projects. Often involves fieldwork and community outreach.",
                trainings: ["Environmental Science (Degree/Diploma)", "Wildlife Management (Degree/Diploma)", "Forestry (Degree/Diploma)", "Waste Management & Recycling (Certificate)", "Climate Change Adaptation (Short Course)"],
                facts: ["Growing global and national emphasis on sustainability.", "Crucial for addressing climate change and resource depletion.", "Involves a mix of scientific research and practical conservation efforts.", "Opportunities in NGOs, government agencies, and research institutions."],
                benefits: ["Direct positive impact on environmental health.", "Work in diverse natural settings.", "Develop expertise in critical global issues.", "Potential for advocacy and policy influence."]
            },
            urban: {
                name: "Urban Renewal",
                icon: "fas fa-city",
                entails: "Revitalizing and redeveloping existing urban areas to improve infrastructure, public spaces, housing, and economic opportunities.",
                howItWorks: "Involves master planning, demolition/reconstruction, infrastructure upgrades (water, sewage, electricity), public transport integration, and community development. Requires collaboration between government, private sector, and local communities.",
                trainings: ["Urban Planning (Degree/Diploma)", "Architecture (Degree/Diploma)", "Sociology/Community Development (Degree/Diploma)", "Real Estate Management (Diploma/Certificate)", "GIS and Remote Sensing (Short Course)"],
                facts: ["Addresses challenges of rapid urbanization.", "Aims to create sustainable, livable cities.", "Often involves significant public and private investment.", "Focus on smart city initiatives and integrated planning."],
                benefits: ["Shape the future of cities and communities.", "Work on interdisciplinary projects.", "Contribute to improved quality of life for urban residents.", "High demand for skilled professionals in planning and development."]
            },
            public: {
                name: "Public Works",
                icon: "fas fa-hard-hat",
                entails: "Encompasses the design, construction, and maintenance of public infrastructure and facilities, including water systems, sanitation, public buildings, and civic amenities.",
                howItWorks: "Managed by government departments and agencies, involving procurement, project oversight, quality control, and public service delivery. Focuses on ensuring essential services and facilities for the populace.",
                trainings: ["Civil Engineering (Degree/Diploma)", "Water and Sanitation Engineering (Degree/Diploma)", "Construction Technology (Diploma/Certificate)", "Procurement and Logistics (Certificate)", "Public Administration (Degree)"],
                facts: ["Foundation of national development and quality of life.", "Stable sector with continuous demand for projects.", "Directly impacts daily lives of citizens.", "Opportunities in various government ministries and parastatals."],
                benefits: ["Serve the public and contribute directly to community well-being.", "Job stability within government structures.", "Diverse roles from engineering to administrative support.", "Opportunities for long-term career in public service."]
            }
        };

        const personalInfoStep = document.getElementById('personalInfoStep');
        const locationStep = document.getElementById('locationStep');
        const paymentStep = document.getElementById('paymentStep');
        const sectorDetailsStep = document.getElementById('sectorDetailsStep');

        const steps = [
            { id: 'step1', element: personalInfoStep, bodyClass: 'step-1-bg' },
            { id: 'step2', element: locationStep, bodyClass: 'step-2-bg' },
            { id: 'step3', element: paymentStep, bodyClass: 'step-3-bg' },
            { id: 'step4', element: sectorDetailsStep, bodyClass: 'step-4-bg' }
        ];
        let currentActiveFormStepIndex = 0;
        let currentlyDisplayedStepElement = steps[0].element;

        const progressStepsElements = steps.map(step => document.getElementById(step.id));

        function updateProgressBar(activeStepIdx, markCompletedUpTo = -1) {
            progressStepsElements.forEach((stepEl, index) => {
                stepEl.classList.remove('active', 'completed');
                if (index === activeStepIdx) {
                    stepEl.classList.add('active');
                }
                if (index < activeStepIdx || index <= markCompletedUpTo) {
                    stepEl.classList.add('completed');
                }
            });
            if (activeStepIdx >= 0 && activeStepIdx < steps.length) {
                document.body.className = steps[activeStepIdx].bodyClass;
            }
        }

        function goToStep(stepIndex, isFromFormFlow = true) {
            currentlyDisplayedStepElement.classList.add('hidden');
            if (isFromFormFlow) {
                currentActiveFormStepIndex = stepIndex;
                currentlyDisplayedStepElement = steps[stepIndex].element;
                updateProgressBar(stepIndex, stepIndex - 1);
            } else {
                currentlyDisplayedStepElement = steps[stepIndex].element;
                updateProgressBar(stepIndex);
            }
            currentlyDisplayedStepElement.classList.remove('hidden');
        }

        goToStep(0, true);

        function togglePasswordVisibility(passwordInputId, toggleIconId) {
            const passwordInput = document.getElementById(passwordInputId);
            const toggleIcon = document.getElementById(toggleIconId);

            if (passwordInput && toggleIcon) {
                toggleIcon.addEventListener('click', function () {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    this.classList.toggle('fa-eye');
                    this.classList.toggle('fa-eye-slash');
                });
            }
        }
        togglePasswordVisibility('password', 'togglePassword');
        togglePasswordVisibility('confirmPassword', 'toggleConfirmPassword');
        togglePasswordVisibility('loginPassword', 'toggleLoginPassword');

        const passwordInput = document.getElementById('password');
        const strengthMeter = document.getElementById('passwordStrength');
        
        passwordInput.addEventListener('input', function() {
            const password = passwordInput.value;
            let strength = 0;
            if (password.length >= 8) strength += 25;
            if (/[A-Z]/.test(password)) strength += 25;
            if (/[0-9]/.test(password)) strength += 25;
            if (/[^A-Za-z0-9]/.test(password)) strength += 25;
            strengthMeter.style.width = strength + '%';
            if (strength < 50) strengthMeter.style.background = '#e74c3c';
            else if (strength < 75) strengthMeter.style.background = '#f39c12';
            else strengthMeter.style.background = '#2ecc71';
        });
        
        document.getElementById('nextBtn1').addEventListener('click', function() {
            let isValid = true;
            const requiredFields = personalInfoStep.querySelectorAll('[required]');
            requiredFields.forEach(field => {
                if (!field.value) {
                    isValid = false;
                    field.style.borderColor = '#e74c3c';
                } else {
                    field.style.borderColor = '#ddd';
                }
            });
            const phone = document.getElementById('phone');
            if (!phone.value.match(/^254[0-9]{9}$/)) {
                isValid = false;
                phone.style.borderColor = '#e74c3c';
                showMessageBox('Please enter a valid Safaricom phone number (format: 2547XXXXXXXX)');
            } else {
                phone.style.borderColor = '#ddd';
            }
            if (!document.querySelector('input[name="gender"]:checked')) {
                isValid = false;
                showMessageBox('Please select your gender.');
            }
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (password !== confirmPassword) {
                isValid = false;
                document.getElementById('password').style.borderColor = '#e74c3c';
                document.getElementById('confirmPassword').style.borderColor = '#e74c3c';
                showMessageBox('Passwords do not match!');
            } else {
                 document.getElementById('password').style.borderColor = '#ddd';
                 document.getElementById('confirmPassword').style.borderColor = '#ddd';
            }
            if (isValid) goToStep(1, true);
        });
        
        document.getElementById('backBtn1').addEventListener('click', () => goToStep(0, true));
        
        document.getElementById('nextBtn2').addEventListener('click', function() {
            let isValid = true;
            ['county', 'constituency', 'ward'].forEach(id => {
                const el = document.getElementById(id);
                if (!el.value) {
                    isValid = false;
                    el.style.borderColor = '#e74c3c';
                } else {
                    el.style.borderColor = '#ddd';
                }
            });
            if (isValid) goToStep(2, true);
        });
        
        document.getElementById('backBtn2').addEventListener('click', () => goToStep(1, true));

        const mpesaOption = document.getElementById('mpesaOption');
        const kcbOption = document.getElementById('kcbOption');
        const mpesaMethodDetails = document.getElementById('mpesaMethod');
        const kcbMethodDetails = document.getElementById('kcbMethod');

        function togglePaymentMethod(method) {
            document.getElementById(method).checked = true;
            mpesaMethodDetails.classList.toggle('active', method === 'mpesa');
            kcbMethodDetails.classList.toggle('active', method === 'kcb');
            mpesaMethodDetails.querySelectorAll('[required]').forEach(f => f.required = (method === 'mpesa'));
            kcbMethodDetails.querySelectorAll('[required]').forEach(f => f.required = (method === 'kcb'));
        }

        mpesaOption.addEventListener('click', () => togglePaymentMethod('mpesa'));
        kcbOption.addEventListener('click', () => togglePaymentMethod('kcb'));
        document.addEventListener('DOMContentLoaded', () => togglePaymentMethod('mpesa'));

        document.getElementById('nextBtn3').addEventListener('click', function() {
            let isValid = true;
            const selectedPaymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            if (selectedPaymentMethod === 'mpesa') {
                const mpesaNumber = document.getElementById('mpesaNumber');
                if (!mpesaNumber.value.match(/^254[0-9]{9}$/)) {
                    isValid = false;
                    mpesaNumber.style.borderColor = '#e74c3c';
                    showMessageBox('Please enter a valid Safaricom M-Pesa number (format: 2547XXXXXXXX)');
                } else {
                    mpesaNumber.style.borderColor = '#ddd';
                }
            } else if (selectedPaymentMethod === 'kcb') {
                ['accountNumber', 'accountName', 'branch'].forEach(id => {
                    const el = document.getElementById(id);
                    if (!el.value) {
                        isValid = false;
                        el.style.borderColor = '#e74c3c';
                    } else {
                        el.style.borderColor = '#ddd';
                    }
                });
                if(!isValid) showMessageBox('Please fill all KCB bank details.');
            }
            if (isValid) {
                displaySectorDetails(document.getElementById('sector').value);
                goToStep(3, true);
            }
        });

        document.getElementById('backBtn4').addEventListener('click', () => goToStep(2, true));
        
        const countyConstituencyMap = {
            nairobi: { 'Westlands': ['Kitisuru', 'Parklands', 'Kangemi'], 'Dagoretti': ['Kawangware', 'Mutuini', 'Waithaka'], 'Langata': ['Karen', 'Nyayo Highrise', 'South C'], 'Embakasi East': ['Upper Savanna', 'Lower Savanna'], 'Mathare': ['Mathare', 'Huruma'] },
            mombasa: { 'Mvita': ['Majengo', 'Old Town', 'Shimanzi'], 'Kisauni': ['Bamburi', 'Mtongwe', 'Kongowea'], 'Likoni': ['Likoni', 'Timbwani'] },
            kisumu: { 'Kisumu Central': ['Market Milimani', 'Shauri Moyo Kaloleni'], 'Kisumu East': ['Manyatta B', 'Kolwa East'], 'Nyakach': ['Central Nyakach', 'West Nyakach'] },
            nakuru: { 'Nakuru Town East': ['Biashara', 'Kivumbini'], 'Nakuru Town West': ['Barut', 'London'], 'Rongai': ['Menengai West', 'Soin'] },
            kiambu: { 'Kiambu Town': ['Township', 'Riabai'], 'Limuru': ['Limuru Central', 'Ngecha Tigoni'], 'Juja': ['Murera', 'Witeithie'] }
        };

        function populateSelect(selectElement, options) {
            selectElement.innerHTML = `<option value="">Select...</option>`;
            options.forEach(option => addOption(selectElement, option.toLowerCase().replace(/ /g, '-'), option));
        }

        document.getElementById('county').addEventListener('change', function() {
            const constituencies = countyConstituencyMap[this.value] ? Object.keys(countyConstituencyMap[this.value]) : [];
            populateSelect(document.getElementById('constituency'), constituencies);
            populateSelect(document.getElementById('ward'), []);
        });
        
        document.getElementById('constituency').addEventListener('change', function() {
            const county = document.getElementById('county').value;
            const wards = countyConstituencyMap[county] && countyConstituencyMap[county][this.options[this.selectedIndex].text] ? countyConstituencyMap[county][this.options[this.selectedIndex].text] : [];
            populateSelect(document.getElementById('ward'), wards);
        });
        
        function addOption(selectElement, value, text) {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = text;
            selectElement.appendChild(option);
        }

        function displaySectorDetails(sectorKey) {
            const displayArea = document.getElementById('selectedSectorDisplay');
            const sector = sectorData[sectorKey];
            if (!sector) {
                displayArea.innerHTML = '<p>No details available for this sector.</p>';
                return;
            }
            displayArea.innerHTML = `
                <h3 style="color:#0a5c36;">${sector.name}</h3>
                <div class="sector-detail-section"><h3>What it Entails</h3><p>${sector.entails}</p></div>
                <div class="sector-detail-section"><h3>How it Works</h3><p>${sector.howItWorks}</p></div>
                <div class="sector-detail-section"><h3>Trainings Available</h3><ul>${sector.trainings.map(t => `<li>${t}</li>`).join('')}</ul></div>
                <div class="sector-detail-section"><h3>Facts & Benefits</h3><ul>
                    ${sector.facts.map(f => `<li><strong>Fact:</strong> ${f}</li>`).join('')}
                    ${sector.benefits.map(b => `<li><strong>Benefit:</strong> ${b}</li>`).join('')}
                </ul></div>`;
        }
        
        document.getElementById('submitBtn').addEventListener('click', function(event) {
            event.preventDefault();
            showMessageBox('Application submitted successfully! You will receive a verification message shortly.', true);
            document.getElementById('signupForm').reset();
            ['county', 'constituency', 'ward'].forEach(id => document.getElementById(id).innerHTML = `<option value="">Select...</option>`);
            document.getElementById('mpesaNumber').value = '';
            document.getElementById('accountNumber').value = '';
            document.getElementById('accountName').value = '';
            document.getElementById('branch').value = '';
            strengthMeter.style.width = '0%';
            goToStep(0, true);
        });

        const loginLink = document.getElementById('loginLink');
        const loginModal = document.getElementById('loginModal');
        const closeModalBtn = document.getElementById('closeModal');
        const loginForm = document.getElementById('loginForm');

        loginLink.addEventListener('click', (e) => { e.preventDefault(); loginModal.classList.add('active'); });
        closeModalBtn.addEventListener('click', () => { loginModal.classList.remove('active'); loginForm.reset(); });
        loginModal.addEventListener('click', (e) => { if (e.target === loginModal) { loginModal.classList.remove('active'); loginForm.reset(); } });

        loginForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            if (email && password) {
                showMessageBox(`Attempting to log in with Email: ${email}`, true);
                loginModal.classList.remove('active');
                loginForm.reset();
            } else {
                showMessageBox('Please enter both email and password.');
            }
        });

        function showMessageBox(message, isSuccess = false) {
            const existingMessageBox = document.getElementById('customMessageBox');
            if (existingMessageBox) existingMessageBox.remove();
            const messageBox = document.createElement('div');
            messageBox.id = 'customMessageBox';
            messageBox.style.cssText = `position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 15px 30px; background-color: ${isSuccess ? '#27ae60' : '#e74c3c'}; color: white; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); z-index: 2000; font-size: 1rem; display: flex; align-items: center; gap: 10px; animation: fadeInOut 4s forwards;`;
            messageBox.innerHTML = `<i class="${isSuccess ? 'fas fa-check-circle' : 'fas fa-exclamation-circle'}"></i><span>${message}</span>`;
            document.body.appendChild(messageBox);
            if (!document.querySelector('style#messageBoxAnimation')) {
                const styleSheet = document.createElement('style');
                styleSheet.id = 'messageBoxAnimation';
                styleSheet.innerHTML = `@keyframes fadeInOut { 0% { opacity: 0; transform: translateX(-50%) translateY(-20px); } 10% { opacity: 1; transform: translateX(-50%) translateY(0); } 90% { opacity: 1; transform: translateX(-50%) translateY(0); } 100% { opacity: 0; transform: translateX(-50%) translateY(-20px); } }`;
                document.head.appendChild(styleSheet);
            }
            setTimeout(() => { if (document.body.contains(messageBox)) messageBox.remove(); }, 4000);
        }

        document.querySelectorAll('.sector-button').forEach(button => {
            button.addEventListener('click', function() {
                displaySectorDetails(this.dataset.sectorKey);
                goToStep(3, false);
            });
        });
    </script>
</body>
</html>
